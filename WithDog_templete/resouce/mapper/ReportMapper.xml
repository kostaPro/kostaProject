<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="store.mapper.ReportMapper">


	<sql id="selectAllReport">
		select reportContents, reportType, reportTargetId, reporterId, status, suspectId
		from eventCommnetReport_tb, meetingCommentReport_tb, meetingReport_tb, reviewCommentReport_tb, reviewReport_tb, spotReport_tb
	</sql>
	
	

	<insert id="createEventCommentReport" parameterType="Report">
		insert into eventCommentReport_tb (reportContents, reportType, reportTargetId, reporterId, status, suspectId)
		values (#{reportContents}, #{reportType}, #{reportTargetId}, #{reporterId}, #{status}, #{suspectId})
	</insert>
	
	<insert id="createMeetingCommentReport" parameterType="Report">
		insert into MeetingCommentReport_tb (reportContents, reportType, reportTargetId, reporterId, status, suspectId)
		values (#{reportContents}, #{reportType}, #{reportTargetId}, #{reporterId}, #{status}, #{suspectId})
	</insert>
	
	<insert id="createMeeingReport" parameterType="Report">
		insert into MeetingReport_tb (reportContents, reportType, reportTargetId, reporterId, status, suspectId)
		values (#{reportContents}, #{reportType}, #{reportTargetId}, #{reporterId}, #{status}, #{suspectId})
	</insert>
	
	<insert id="createReviewCommentReport" parameterType="Report">
		insert into ReviewCommentReport_tb (reportContents, reportType, reportTargetId, reporterId, status, suspectId)
		values (#{reportContents}, #{reportType}, #{reportTargetId}, #{reporterId}, #{status}, #{suspectId})
	</insert>
	
	<insert id="createReviewReport" parameterType="Report">
		insert into ReviewReport_tb (reportContents, reportType, reportTargetId, reporterId, status, suspectId)
		values (#{reportContents}, #{reportType}, #{reportTargetId}, #{reporterId}, #{status}, #{suspectId})
	</insert>
	
	<insert id="createSpotReport" parameterType="Report">
		insert into spotReport_tb (reportContents, reportType, reportTargetId, reporterId, status, suspectId)
		values (#{reportContents}, #{reportType}, #{reportTargetId}, #{reporterId}, #{status}, #{suspectId})
	</insert>
	
	
	
	
	
	<select id="retrieveReportsByReporterId" parameterType="String" resultType="Rerport">
		<include refid="selectAllReport"></include>
		where reportId = #{reportId}
	</select>
	
	<select id="retrieveReportsBySuspectId" parameterType="String" resultType="Rerport">//
		<include refid="selectAllReport"></include>
		where suspectId = #{suspectId}
	</select>
	
	<select id="retrieveAllReports" resultType="Rerport">
		<include refid="selectAllReport"></include>
	</select>
	
	<select id="retrieveReportsByReportType" parameterType="String" resultType="Rerport">
		<include refid="selectAllReport"></include>
		where reportType = #{reportType}
	</select>
	
	<select id="retrieveBlackList" parameterType="String" resultType="Rerport">//
		select suspectId, count(*) 신고횟수
		from eventCommnetReport_tb, meetingCommentReport_tb, meetingReport_tb, reviewCommentReport_tb, reviewReport_tb, spotReport_tb
		group by suspectId
		having status="경고?"
	</select>
	
	<select id="retrieveReport" parameterType="Map" resultType="Rerport">
		<include refid="selectAllReport"></include>
		where reportId = #{reportId} and retportTargetId = #{reportTargetId}
	</select>
	
	
	
	
	
	<update id="updateEventCommentReport" parameterType="Report">
		update into eventCommentReport_tb
		set status = #{status}
		where reportId = #{reportId}
	</update>
	
	<update id="updateMeetingCommentReport" parameterType="Report">
		update into meetingCommentReport_tb
		set status = #{status}
		where reportId = #{reportId}
	</update>
	
	<update id="updateMeeingReport" parameterType="Report">
		update into meetingReport_tb
		set status = #{status}
		where reportId = #{reportId}
	</update>
	
	<update id="updateReviewCommentReport" parameterType="Report">
		update into report_tb
		set status = #{status}
		where reportId = #{reportId}
	</update>
	
	<update id="updateReviewReport" parameterType="Report">
		update into report_tb
		set status = #{status}
		where reportId = #{reportId}
	</update>
	
	<update id="updateSpotReport" parameterType="Report">
		update into spotReport_tb
		set status = #{status}
		where reportId = #{reportId}
	</update>
	
	
	
	<delete id="deleteEventCommentReport" parameterType="integer">
		delete from eventCommentReport_tb
		where reportId = #{reportId}
	</delete>
	
	<delete id="deleteMeetingCommentReport" parameterType="integer">
		delete from meetingCommentReport_tb
		where reportId = #{reportId}
	</delete>
	
	<delete id="deleteMeeingReport" parameterType="integer">
		delete from meetingReport_tb
		where reportId = #{reportId}
	</delete>

	<delete id="deleteReviewCommentReport" parameterType="integer">
		delete from reviewCommentReport_tb
		where reportId = #{reportId}
	</delete>
		
	<delete id="deleteReviewCommentReport" parameterType="integer">
		delete from reviewCommentReport_tb
		where reportId = #{reportId}
	</delete>
	
	<delete id="deleteReviewReport" parameterType="integer">
		delete from reviewReport_tb
		where reportId = #{reportId}
	</delete>
	
	<delete id="deleteSpotReport" parameterType="integer">
		delete from spotReport_tb
		where reportId = #{reportId}
	</delete>
		
</mapper>